{
  "$schema": "../cdk.schema.json",
  "Resources": {
    "SourceBucket": {
      "Type": "aws-cdk-lib.aws_s3.Bucket"
    },
    "BusinessLogic": {
      "Type": "aws-cdk-lib.aws_lambda.Code",
      "Call": {
        "aws-cdk-lib.aws_lambda.Code.fromBucket": {
          "bucket": {
            "Ref": "SourceBucket"
          },
          "key": "foo-bar"
        }
      }
    },
    "MyFunction": {
      "Type": "aws-cdk-lib.aws_lambda.Function",
      "Properties": {
        "handler": "index.handler",
        "runtime": "NODEJS_14_X",
        "code": {
          "Ref": "BusinessLogic"
        }
      }
    },
    "Grant": {
      "Type": "aws-cdk-lib.aws_iam.Grant",
      "On": "SourceBucket",
      "Call": {
        "grantRead": {
          "identity": {"Ref": "MyFunction"}
        }
      }
    },
    "Alias": {
      "Type": "aws-cdk-lib.aws_lambda.Alias",
      "On": "MyFunction",
      "Call": {
        "addAlias": {
          "aliasName": "live"
        }
      }
    },
    "ConfigureAsyncInvokeStatement": {
      "On": "Alias",
      "Call": {
        "configureAsyncInvoke": {
          "retryAttempts": 2
        }
      }
    }
  }
}
